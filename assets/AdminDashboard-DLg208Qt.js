import{r as n,j as e}from"./index-D92zG21L.js";const c="https://script.google.com/macros/s/AKfycbyignjYeqRXL-eont5SZ2Nao4e02PMQUuOvUD5s0LzTB932U60p4QRWfXvCa0cIV_ZcQw/exec";function A(){const[d,h]=n.useState("Post Offers"),[b,f]=n.useState([]),[g,j]=n.useState([]),[u,m]=n.useState(!1),[o,i]=n.useState(!1),[a,l]=n.useState({title:"",brand:"Apple",category:"Mobiles",price:"",image:"",description:"",imageBase64:"",mimeType:""}),v=t=>{const r=t.target.files[0];if(r){if(r.size>4*1024*1024)return alert("Image too large. Max 4MB.");const s=new FileReader;s.onloadend=()=>{const p=s.result.split(",")[1];l(y=>({...y,imageBase64:p,mimeType:r.type,image:y.image||"Uploading..."}))},s.readAsDataURL(r)}};n.useEffect(()=>{d==="orders"&&k(),(d==="products"||d==="Post Offers")&&x()},[d]);async function k(){m(!0);try{const r=await(await fetch(`${c}?action=getOrders`)).json();f(Array.isArray(r.data)?r.data:[])}catch(t){console.error("Fetch orders failed",t)}m(!1)}async function x(){m(!0);try{const s=await(await fetch(`${c}?action=${d==="Post Offers"?"getOffers":"getProducts"}`)).json();j(Array.isArray(s.data)?s.data:[])}catch(t){console.error("Fetch failed",t)}m(!1)}async function w(t,r,s,p,y){if(!window.confirm(`Update status to ${r}?`))return;const N=[...b];N[t][11]=r,f(N),await fetch(c,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"updateStatus",rowIndex:t,status:r})})}async function P(t){if(t.preventDefault(),!a.title||!a.price)return alert("Title and Price required");i(!0);try{await fetch(c,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"addProduct",...a})}),alert("Product Added Successfully!"),alert("Product Added Successfully!"),l({title:"",brand:"Apple",category:"Mobiles",price:"",image:"",description:"",imageBase64:"",mimeType:""}),x()}catch(r){console.error(r),alert("Failed to add product. Error: "+r.toString())}i(!1)}async function O(t){if(window.confirm("Are you sure you want to delete this product?")){i(!0);try{await fetch(c,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"deleteProduct",id:t})}),j(g.filter(r=>r.id!==t))}catch{alert("Failed to delete")}i(!1)}}return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-primary-dark p-4 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"mb-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsx("h2",{className:"text-3xl font-heading font-bold text-slate-800 dark:text-white",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex bg-white dark:bg-primary-light rounded-lg p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>h("orders"),className:`px-6 py-2 rounded-md font-medium transition-all ${d==="orders"?"bg-accent text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:"Orders"}),e.jsx("button",{onClick:()=>h("products"),className:`px-6 py-2 rounded-md font-medium transition-all ${d==="products"?"bg-accent text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:"Manage Products"}),e.jsx("button",{onClick:()=>h("Post Offers"),className:`px-6 py-2 rounded-md font-medium transition-all ${d==="Post Offers"?"bg-accent text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:"Post Offers"})]})]}),d==="orders"&&e.jsx("div",{className:"bg-white dark:bg-primary-light rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:u?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading Orders..."}):b.length===0?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"No Orders Found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Date"}),e.jsx("th",{className:"p-4",children:"Customer"}),e.jsx("th",{className:"p-4",children:"Product"}),e.jsx("th",{className:"p-4",children:"Amount"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:b.map((t,r)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-4 whitespace-nowrap",children:new Date(t[0]).toLocaleDateString()}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:t[1]}),e.jsx("div",{className:"text-xs text-gray-500",children:t[2]})]}),e.jsx("td",{className:"p-4 text-slate-700 dark:text-gray-300",children:t[5]}),e.jsxs("td",{className:"p-4 font-bold text-green-600",children:["₹",t[6]]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold 
                               ${t[11]==="Approved"?"bg-green-100 text-green-700":t[11]==="Denied"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t[11]||"Pending"})}),e.jsx("td",{className:"p-4",children:e.jsxs("select",{defaultValue:t[11],onChange:s=>w(r,s.target.value,t[2],t[1],t[5]),className:"bg-gray-50 dark:bg-primary-dark border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-xs",disabled:o,children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approve"}),e.jsx("option",{value:"Denied",children:"Deny"})]})})]},r))})]})})}),d==="products"&&e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 p-6 h-fit sticky top-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"Add New Product"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product Title"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"e.g. iPhone 16 Pro",value:a.title,onChange:t=>l({...a,title:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Brand"}),e.jsx("select",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",value:a.brand,onChange:t=>l({...a,brand:t.target.value}),children:["Apple","Samsung","OnePlus","Google","Xiaomi","Nothing"].map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsx("select",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",value:a.category,onChange:t=>l({...a,category:t.target.value}),children:["Mobiles","Laptops","Tablets","Accessories","Smart Watches","AirPods"].map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Price (₹)"}),e.jsx("input",{type:"number",className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"e.g. 129000",value:a.price,onChange:t=>l({...a,price:t.target.value})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product Description"}),e.jsx("textarea",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"Enter product features, condition, warranty...",rows:"3",value:a.description,onChange:t=>l({...a,description:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Image (Upload OR URL)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:v,className:`block w-full text-sm text-gray-500\r
                        file:mr-4 file:py-2 file:px-4\r
                        file:rounded-full file:border-0\r
                        file:text-sm file:font-semibold\r
                        file:bg-violet-50 file:text-violet-700\r
                        hover:file:bg-violet-100 mb-2\r
                      `}),e.jsx("div",{className:"text-center text-xs text-gray-400 my-1",children:"- OR -"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"https://...",value:a.image,onChange:t=>l({...a,image:t.target.value})})]})]}),e.jsx("button",{disabled:o,className:"w-full btn-primary py-3 rounded-xl shadow-lg mt-4 disabled:opacity-50",children:o?"Adding...":"Add Product"})]})]}),e.jsx("div",{className:"lg:col-span-2",children:u?e.jsx("div",{className:"bg-white dark:bg-primary-light rounded-2xl p-8 text-center",children:"Loading Products..."}):g.length===0?e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-2xl p-8 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"No products found in database."}),e.jsx("p",{className:"text-sm text-yellow-600",children:"Ensure you have updated the Google Apps Script!"})]}):e.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:g.map(t=>e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-xl border border-gray-200 dark:border-gray-700 p-4 flex gap-4 items-center",children:[e.jsx("img",{src:t.image||"https://via.placeholder.com/150",alt:t.title,className:"w-16 h-16 object-contain bg-gray-50 rounded-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white truncate",children:t.title}),e.jsx("div",{className:"text-sm text-gray-500",children:t.category}),e.jsxs("div",{className:"font-bold text-accent",children:["₹",Number(t.price).toLocaleString("en-IN")]})]}),e.jsx("button",{onClick:()=>O(t.id),disabled:o,className:"text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:"Delete"})]},t.id))})})]}),d==="Post Offers"&&e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 p-6 h-fit sticky top-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"Add New Offer Banner"}),e.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!a.image&&!a.imageBase64)return alert("Image URL or Upload required");const r={title:a.title||"Offer Banner",image:a.image,imageBase64:a.imageBase64,mimeType:a.mimeType};i(!0);try{await fetch(c,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"addOffer",...r})}),alert("Offer Posted Successfully!"),l({title:"",brand:"Apple",category:"Mobiles",price:"",image:"",description:"",imageBase64:"",mimeType:""}),x()}catch(s){console.error(s),alert("Failed to post offer.")}i(!1)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Offer Title (Optional)"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"e.g. Diwali Sale",value:a.title,onChange:t=>l({...a,title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Banner Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100 mb-2"}),e.jsx("div",{className:"text-center text-xs text-gray-400 my-1",children:"- OR -"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"Image URL",value:a.image,onChange:t=>l({...a,image:t.target.value})})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-xs text-blue-600 dark:text-blue-300",children:"Tip: Use landscape images (16:9) for best results."}),e.jsx("button",{disabled:o,className:"w-full btn-primary py-3 rounded-xl shadow-lg mt-4 disabled:opacity-50",children:o?"Posting...":"Post Offer"})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"Active Offers"}),u?e.jsx("div",{className:"text-center",children:"Loading..."}):e.jsxs("div",{className:"grid gap-4",children:[g.map(t=>{var r,s;return e.jsxs("div",{className:"relative group bg-white dark:bg-primary-light rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("img",{src:(r=t.image)!=null&&r.startsWith("http")?t.image:`/SanthoshMobilesHub2026/${(s=t.image)!=null&&s.startsWith("/")?t.image.slice(1):t.image}`,alt:t.title,className:"w-full h-48 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-4",children:e.jsx("button",{onClick:async()=>{if(window.confirm("Delete this offer?")){i(!0);try{await fetch(c,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"deleteOffer",id:t.id})}),x()}catch{alert("Failed to delete")}i(!1)}},disabled:o,className:"bg-red-500 text-white px-4 py-2 rounded-lg font-bold hover:bg-red-600 transition-colors",children:"Delete Post"})}),e.jsx("div",{className:"p-3",children:e.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:t.title})})]},t.id)}),g.length===0&&e.jsx("div",{className:"text-gray-500 text-center py-10",children:"No active offers. Post one to see it on the Homepage!"})]})]})]})]})})}export{A as default};
