import{r as s,j as e}from"./index-CHjnFOCb.js";const o="https://script.google.com/macros/s/AKfycbzkrLj5kD6dX5on-oQ_2aMPJYfx3rnRZktGhdzLnwRbkYLAr6JzbBm9JQZ2sTB9uU0_Mw/exec";function S(){const[d,h]=s.useState("orders"),[g,m]=s.useState([]),[x,u]=s.useState([]),[p,n]=s.useState(!1),[i,c]=s.useState(!1),[t,l]=s.useState({title:"",brand:"Apple",category:"Mobiles",price:"",image:""});s.useEffect(()=>{d==="orders"&&j(),d==="products"&&b()},[d]);async function j(){n(!0);try{const a=await(await fetch(`${o}?action=getOrders`)).json();m(Array.isArray(a.data)?a.data:[])}catch(r){console.error("Fetch orders failed",r)}n(!1)}async function b(){n(!0);try{const a=await(await fetch(`${o}?action=getProducts`)).json();u(Array.isArray(a.data)?a.data:[])}catch(r){console.error("Fetch products failed",r)}n(!1)}async function N(r,a,y,w,P){if(!window.confirm(`Update status to ${a}?`))return;const f=[...g];f[r][11]=a,m(f),await fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"updateStatus",rowIndex:r,status:a})})}async function k(r){if(r.preventDefault(),!t.title||!t.price)return alert("Title and Price required");c(!0);try{await fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"addProduct",...t})}),alert("Product Added Successfully!"),l({title:"",brand:"Apple",category:"Mobiles",price:"",image:""}),b()}catch{alert("Failed to add product")}c(!1)}async function v(r){if(window.confirm("Are you sure you want to delete this product?")){c(!0);try{await fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify({action:"deleteProduct",id:r})}),u(x.filter(a=>a.id!==r))}catch{alert("Failed to delete")}c(!1)}}return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-primary-dark p-4 md:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"mb-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsx("h2",{className:"text-3xl font-heading font-bold text-slate-800 dark:text-white",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex bg-white dark:bg-primary-light rounded-lg p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>h("orders"),className:`px-6 py-2 rounded-md font-medium transition-all ${d==="orders"?"bg-accent text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:"Orders"}),e.jsx("button",{onClick:()=>h("products"),className:`px-6 py-2 rounded-md font-medium transition-all ${d==="products"?"bg-accent text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:"Manage Products"})]})]}),d==="orders"&&e.jsx("div",{className:"bg-white dark:bg-primary-light rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden",children:p?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Loading Orders..."}):g.length===0?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"No Orders Found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Date"}),e.jsx("th",{className:"p-4",children:"Customer"}),e.jsx("th",{className:"p-4",children:"Product"}),e.jsx("th",{className:"p-4",children:"Amount"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:g.map((r,a)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-4 whitespace-nowrap",children:new Date(r[0]).toLocaleDateString()}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:r[1]}),e.jsx("div",{className:"text-xs text-gray-500",children:r[2]})]}),e.jsx("td",{className:"p-4 text-slate-700 dark:text-gray-300",children:r[5]}),e.jsxs("td",{className:"p-4 font-bold text-green-600",children:["₹",r[6]]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold 
                               ${r[11]==="Approved"?"bg-green-100 text-green-700":r[11]==="Denied"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:r[11]||"Pending"})}),e.jsx("td",{className:"p-4",children:e.jsxs("select",{defaultValue:r[11],onChange:y=>N(a,y.target.value,r[2],r[1],r[5]),className:"bg-gray-50 dark:bg-primary-dark border border-gray-300 dark:border-gray-700 rounded px-2 py-1 text-xs",disabled:i,children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approve"}),e.jsx("option",{value:"Denied",children:"Deny"})]})})]},a))})]})})}),d==="products"&&e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 p-6 h-fit sticky top-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-6",children:"Add New Product"}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product Title"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"e.g. iPhone 16 Pro",value:t.title,onChange:r=>l({...t,title:r.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Brand"}),e.jsx("select",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",value:t.brand,onChange:r=>l({...t,brand:r.target.value}),children:["Apple","Samsung","OnePlus","Google","Xiaomi","Nothing"].map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsx("select",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",value:t.category,onChange:r=>l({...t,category:r.target.value}),children:["Mobiles","Laptops","Tablets","Accessories","Smart Watches","AirPods"].map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Price (₹)"}),e.jsx("input",{type:"number",className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"e.g. 129000",value:t.price,onChange:r=>l({...t,price:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Image URL"}),e.jsx("input",{className:"w-full bg-gray-50 dark:bg-primary-dark border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 outline-none focus:border-accent",placeholder:"https://...",value:t.image,onChange:r=>l({...t,image:r.target.value})}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Upload image to Imgur/Drive and paste direct link here."})]}),e.jsx("button",{disabled:i,className:"w-full btn-primary py-3 rounded-xl shadow-lg mt-4 disabled:opacity-50",children:i?"Adding...":"Add Product"})]})]}),e.jsx("div",{className:"lg:col-span-2",children:p?e.jsx("div",{className:"bg-white dark:bg-primary-light rounded-2xl p-8 text-center",children:"Loading Products..."}):x.length===0?e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-2xl p-8 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"No products found in database."}),e.jsx("p",{className:"text-sm text-yellow-600",children:"Ensure you have updated the Google Apps Script!"})]}):e.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:x.map(r=>e.jsxs("div",{className:"bg-white dark:bg-primary-light rounded-xl border border-gray-200 dark:border-gray-700 p-4 flex gap-4 items-center",children:[e.jsx("img",{src:r.image||"https://via.placeholder.com/150",alt:r.title,className:"w-16 h-16 object-contain bg-gray-50 rounded-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white truncate",children:r.title}),e.jsx("div",{className:"text-sm text-gray-500",children:r.category}),e.jsxs("div",{className:"font-bold text-accent",children:["₹",Number(r.price).toLocaleString("en-IN")]})]}),e.jsx("button",{onClick:()=>v(r.id),disabled:i,className:"text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 p-2 rounded-lg transition-colors",children:"Delete"})]},r.id))})})]})]})})}export{S as default};
